
---
import ArticleCard from '../components/ArticleCard.astro';
import fs from 'fs';
import path from 'path';
import matter from 'gray-matter';

const postsDir = '../../content/posts';
const postFiles = fs.readdirSync(new URL(postsDir, import.meta.url));
const posts = postFiles.map(file => {
  const filePath = new URL(`${postsDir}/${file}`, import.meta.url);
  const raw = fs.readFileSync(filePath, 'utf-8');
  const { data } = matter(raw);
  return { ...data };
});
---

<html>
  <head>
    <title>The Mwaniki's Report</title>
    <meta charset="UTF-8" />
  </head>
  <body style="font-family: sans-serif; background: white; color: black; margin: 0;">
    <header style="background: red; color: white; padding: 1rem;">
      <h1>The Mwaniki's Report</h1>
    </header>
    <main style="padding: 1rem;">
      <h2>Latest Articles</h2>
      {posts.map(post => <ArticleCard title={post.title} description={post.description} slug={post.slug} />)}
    </main>
    <footer style="background: black; color: white; padding: 1rem; text-align: center;">
      Contact: info@jonathanmwaniki.co.ke | Phone: 0706396305
    </footer>
  </body>
</html>
